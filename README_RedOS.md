# Запуск программы на RedOS

Данная инструкция описывает процесс настройки окружения и запуска программы `excel_merger.py` на операционной системе RedOS (или других RPM-based дистрибутивах, таких как CentOS, Fedora, RHEL).

## Предварительные требования

Для работы программы необходимо наличие Python 3 и библиотеки Tkinter.

## Шаг 1: Установка системных зависимостей

Откройте терминал и выполните следующие команды для установки Python 3, pip и Tkinter:

```bash
sudo dnf update
sudo dnf install python3 python3-pip python3-tkinter
```

*Примечание: Если `dnf` недоступен, используйте `yum`.*

## Шаг 2: Настройка виртуального окружения (рекомендуется)

Рекомендуется использовать виртуальное окружение, чтобы не засорять системный Python.

1.  Перейдите в папку с проектом:
    ```bash
    cd /путь/к/вашей/папке/Soft_Analiz_UI_OGPZ_ONGKM
    ```

2.  Создайте виртуальное окружение:
    ```bash
    python3 -m venv venv
    ```

3.  Активируйте виртуальное окружение:
    ```bash
    source venv/bin/activate
    ```

## Шаг 3: Установка зависимостей Python

Установите необходимые библиотеки. 

**Вариант А: Установка только для `excel_merger.py` (минимальный набор)**
Если вы планируете использовать только программу объединения Excel файлов:

```bash
pip install pandas openpyxl xlrd numpy
```

**Вариант Б: Установка всех зависимостей проекта**
Если вы планируете использовать весь функционал проекта (при наличии всех файлов):

```bash
pip install -r requirements.txt
```

## Шаг 4: Запуск программы

После установки зависимостей вы можете запустить программу:

```bash
python3 excel_merger.py
```

## Возможные проблемы

1.  **Ошибка `ModuleNotFoundError: No module named 'tkinter'`**:
    Убедитесь, что вы установили пакет `python3-tkinter` (см. Шаг 1).

2.  **Ошибка `ImportError: libGL.so.1: cannot open shared object file`** (если используете OpenCV):
    Установите библиотеку mesa-libGL:
    ```bash
    sudo dnf install mesa-libGL
    ```

3.  **Проблемы с правами доступа**:
    Если скрипт не запускается, попробуйте дать ему права на исполнение:
    ```bash
    chmod +x excel_merger.py
    ```

## Альтернативный способ: Установка как приложения

Вы можете установить программу как обычное приложение с ярлыком в меню.

1.  Сделайте скрипт установки исполняемым:
    ```bash
    chmod +x install_redos.sh
    ```

2.  Запустите установку (требуются права администратора):
    ```bash
    sudo ./install_redos.sh
    ```

После установки программа появится в меню приложений под названием "Аналитика УИ ОГПЗ".

Для удаления программы используйте скрипт `uninstall_redos.sh`:
```bash
chmod +x uninstall_redos.sh
sudo ./uninstall_redos.sh
```

## Создание и установка .whl пакета

Для переноса программы на другой компьютер можно использовать `.whl` пакет.

### 1. Создание пакета (на компьютере разработчика)

Запустите скрипт сборки:
```bash
chmod +x build_wheel.sh
./build_wheel.sh
```

В папке `dist/` появится файл вида `analytics_ui_ogpz-1.2.0-py3-none-any.whl`.

### 2. Установка (на целевом компьютере)

1.  Скопируйте `.whl` файл на целевой компьютер в любую удобную папку (например, в домашнюю папку `~/` или `/home/username/`).
2.  Установите системные зависимости (см. Шаг 1 основной инструкции).
3.  Откройте терминал в папке с файлом и установите пакет:
    ```bash
    pip3 install analytics_ui_ogpz-1.2.3-py3-none-any.whl
    ```

### 3. Настройка ярлыков

Чтобы создать ярлыки на рабочем столе и в меню приложений, выполните команду:
```bash
analytics-ui-setup
```

### 4. Запуск

После установки программу можно запустить через ярлык на рабочем столе или командой:
```bash
analytics-ui
```

### Возможные ошибки при установке .whl

**Ошибка: `bash: pip3: команда не найдена`**

Это означает, что не установлен менеджер пакетов pip.
1. Установите его командой:
   ```bash
   sudo dnf install python3-pip
   ```
2. Или попробуйте использовать команду через python:
   ```bash
   python3 -m pip install analytics_ui_ogpz-1.2.0-py3-none-any.whl
   ```

**Ошибка: `ModuleNotFoundError: No module named 'tkinter'`**

Это означает, что не установлена графическая библиотека.
Выполните команду:
```bash
sudo dnf install python3-tkinter
```
